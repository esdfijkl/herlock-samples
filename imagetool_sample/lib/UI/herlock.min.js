var hlk;!function(hlk){function isCached(url){return!!cache[url]}function imports(scripts,useCache){return"undefined"==typeof useCache&&(useCache=!0),new Imports(scripts,useCache)}hlk.VERSION="0.1.1";var cache={},Imports=function(){function Imports(scripts,useCache){var _this=this;this.onLoadHandler=function(event){var target=event.target;target.removeEventListener("load",_this.onLoadHandler,!1),target.onload=null,++_this.loaded===_this.limit&&(cache[target.src]=!0,_this.completeHandler()),_this.completeHandler=null},this.done=function(callback){_this.isComplete?callback():"function"==typeof callback&&(_this.completeHandler=callback)};var i;for(this.isComplete=!1,this.completeHandler=function(){},this.loaded=0,this.limit=scripts.length,i=0;i<this.limit;i++)if(useCache&&isCached(scripts[i]))this.loaded++;else{var loader=new Script;loader.src=scripts[i],loader.addEventListener("load",this.onLoadHandler,!1)}this.loaded===this.limit&&(this.isComplete=!0)}return Imports}();hlk.imports=imports}(hlk||(hlk={}));var hlk;!function(hlk){var ObserverEvent=function(){function ObserverEvent(type,data,target){"undefined"==typeof type&&(type="event"),"undefined"==typeof data&&(data={}),"undefined"==typeof target&&(target=null),this.type=type,this.target=target,this.data=data}return ObserverEvent}();hlk.ObserverEvent=ObserverEvent;var Observer=function(){function Observer(){this.listeners={}}return Observer.prototype.addObserver=function(type,listener,context){"undefined"==typeof context&&(context=null);var listeners=this.listeners;listeners[type]||(listeners[type]=[]),listeners[type].push({listener:listener,context:context})},Observer.prototype.removeObserver=function(type,listener){var listeners=this.listeners;if(listeners[type]){var i,len=listeners[type].length;for(i=len-1;i>=0;i--){var entry=listeners[type][i];entry.listener===listener&&listeners[type].splice(i,1)}}},Observer.prototype.removeObservers=function(type){var listeners=this.listeners;listeners[type]&&delete[type]},Observer.prototype.observeEvent=function(event,async){"undefined"==typeof async&&(async=!1);var listeners=this.listeners,type=event.type;if(listeners[type]){var i,len=listeners[type].length;for(i=0;len>i;i++){var entry=listeners[type][i],context=entry.context||event.target;async?setTimeout(this.createCaller(entry.listener,context,event),0):entry.listener.call(context,event)}}},Observer.prototype.notify=function(type,data,async){"undefined"==typeof data&&(data=null),"undefined"==typeof async&&(async=!1);var event=new ObserverEvent;event.type=type,event.target=this,event.data=data,this.observeEvent(event,async)},Observer.prototype.createCaller=function(listener,context,event){return function(){listener.call(context,event)}},Observer}();hlk.Observer=Observer}(hlk||(hlk={}));var hlk;!function(hlk){!function(utils){var StringUtil=function(){function StringUtil(){}return StringUtil.sprintf=function(text){for(var replacement=[],_i=0;_i<arguments.length-1;_i++)replacement[_i]=arguments[_i+1];for(var i;i<replacement.length;i++)text=text.replace("%s",replacement[i]);return text},StringUtil.getUnique=function(){return"ns_"+String(StringUtil.uniqueStringCounter++)},StringUtil.startsWith=function(text,prefix){return 0===text.indexOf(prefix)},StringUtil.endsWith=function(text,postfix){return 0===text.lastIndexOf(postfix,0)},StringUtil.contains=function(text,needle){return-1!==text.indexOf(needle)},StringUtil.htmlEncode=function(text){return text.replace(/&/g,"&amp;").replace(/&amp;amp;/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},StringUtil.ucFirst=function(text){return text+="",text.charAt(0).toUpperCase()+text.substr(1)},StringUtil.fillZero=function(value,length){if(String(value).length>=length)return String(value);var numbers=[];return numbers.length=length+1-value.toString().split("").length,numbers.join("0")+value},StringUtil.uniqueStringCounter=2147483648*Math.random()|0,StringUtil}();utils.StringUtil=StringUtil}(hlk.utils||(hlk.utils={}));var utils=hlk.utils}(hlk||(hlk={}));var hlk;!function(hlk){!function(utils){var ObjectUtil=function(){function ObjectUtil(){}return ObjectUtil.merge=function(obj1,obj2){var ret={},name;for(name in obj1)obj1.hasOwnProperty(name)&&(ret[name]=obj1[name]);for(name in obj2)obj2.hasOwnProperty(name)&&(ret[name]=obj2[name]);return ret},ObjectUtil.mixin=function(base,include){for(var name in include)base[name]=include[name];return base},ObjectUtil}();utils.ObjectUtil=ObjectUtil}(hlk.utils||(hlk.utils={}));var utils=hlk.utils}(hlk||(hlk={}));var hlk;!function(hlk){!function(utils){var DisplayUtil=function(){function DisplayUtil(){}return DisplayUtil.removeAllChildren=function(container){for(var len=container.numChildren,i=0;len>i;i++)container.removeChildAt(0)},DisplayUtil.clearAllChildren=function(container,recursive){"undefined"==typeof recursive&&(recursive=!1);for(var len=container.numChildren,removed,i=0;len>i;i++)removed=container.removeChildAt(0),removed.removeAllEventListeners(),removed instanceof Sprite&&recursive&&DisplayUtil.clearAllChildren(removed)},DisplayUtil}();utils.DisplayUtil=DisplayUtil}(hlk.utils||(hlk.utils={}));var utils=hlk.utils}(hlk||(hlk={}));var hlk;!function(hlk){!function(net){var HttpMethod=function(){function HttpMethod(){}return HttpMethod.GET="get",HttpMethod.POST="post",HttpMethod.PUT="put",HttpMethod.DELETE="delete",HttpMethod}();net.HttpMethod=HttpMethod}(hlk.net||(hlk.net={}));var net=hlk.net}(hlk||(hlk={}));var hlk;!function(hlk){!function(net){var HttpUtil=function(){function HttpUtil(){}return HttpUtil.buildQuery=function(params){var query=[];for(var key in params)if(params.hasOwnProperty(key)&&params[key]instanceof Array){var i,m=params[key].length;for(i=0;m>i;i++)query.push(key+"[]="+encodeURIComponent(params[key][i]))}else query.push(key+"="+encodeURIComponent(params[key]));return query.join("&")},HttpUtil.isValidUrl=function(url){return HttpUtil.URL_PATTERN.test(url)},HttpUtil.parseQuery=function(text){if(!text)return{};var index=text.indexOf("?"),params={};if(text=-1===index?text:text.substr(index+1),params.query=decodeURIComponent(text),text&&""!=text)for(var qsa=text.split("&"),i=0;i<qsa.length;i++){var pair=qsa[i].split("=");if("undefined"!=typeof pair[0]&&"undefined"!=typeof pair[1]){var pn,matcher=pair[0].match(/\[\]/),isArray=matcher&&"[]"===matcher[0];isArray?(pn=pair[0].replace("[]",""),"undefined"==typeof params[pn]&&(params[pn]=[]),params[pn].push(decodeURIComponent(pair[1]))):params[pair[0]]=decodeURIComponent(pair[1])}}return params},HttpUtil.URL_PATTERN=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i"),HttpUtil}();net.HttpUtil=HttpUtil}(hlk.net||(hlk.net={}));var net=hlk.net}(hlk||(hlk={}));var hlk;!function(hlk){!function(net){var ObjectUtil=hlk.utils.ObjectUtil,HttpClient=function(){function HttpClient(method){"undefined"==typeof method&&(method=net.HttpMethod.GET),this.requestBody=null,this.setMethod(method),this.headers={X_REQUESTED_WITH:"XMLHttpRequest"}}return HttpClient.prototype.setMethod=function(method){this.method=method.toLowerCase()===net.HttpMethod.GET?net.HttpMethod.GET:net.HttpMethod.POST},HttpClient.prototype.getMethod=function(){return this.method},HttpClient.prototype.addHeader=function(name,value){this.headers[name]=value},HttpClient.prototype.getHeaders=function(){return this.headers},HttpClient.prototype.getHeader=function(name){return this.headers[name]},HttpClient.prototype.removeHeader=function(name){delete this.headers[name]},HttpClient.prototype.addHeaders=function(headers){for(var name in headers)headers.hasOwnProperty(name)&&this.addHeader(name,headers[name])},HttpClient.prototype.abort=function(){if(null!=this.xhr){var xhr=this.xhr;this.clearRequest(),xhr.abort()}},HttpClient.prototype.setRequestBody=function(param){this.requestBody=param instanceof FormData||"string"==typeof param?param:net.HttpUtil.buildQuery(param)},HttpClient.prototype.getRequestBody=function(){return this.requestBody},HttpClient.prototype.setQueryParams=function(param){this.queryParam=ObjectUtil.merge(this.getQueryParams(),param)},HttpClient.prototype.getQueryParams=function(){return this.queryParam},HttpClient.prototype.addQueryParam=function(key,value){this.queryParam[key]=value},HttpClient.prototype.removeQueryParam=function(key){delete this.queryParam[key]},HttpClient.prototype.getQueryParam=function(key){return this.queryParam[key]},HttpClient.prototype.getQueryString=function(){return net.HttpUtil.buildQuery(this.getQueryParams())},HttpClient.prototype.setUrl=function(url){if(!net.HttpUtil.isValidUrl(url))throw new Error("invalid url.");this.url=url},HttpClient.prototype.getUrl=function(){return this.url},HttpClient.prototype.buildUrl=function(){var url=this.getUrl(),query=this.getQueryString();return-1===url.indexOf("?")&&query?url+="?":"&"!=url.substr(url.length-1,1)&&query&&(url+="&"),url+=""!=query?query:""},HttpClient.prototype.clearRequest=function(){this.xhr.onreadystatechange=this.xhr.onabort=this.xhr.onerror=null,this.xhr=null},HttpClient.prototype.send=function(success,error){"undefined"==typeof success&&(success=null),"undefined"==typeof error&&(error=null);var _this=this;if(this.xhr)throw new Error("Request dose sent");var xhr=new XMLHttpRequest,headers=this.getHeaders();xhr.onreadystatechange=function(){4===xhr.readyState&&("function"==typeof success&&success(xhr),_this.clearRequest())},xhr.onabort=xhr.onerror=function(){"function"==typeof error&&error(xhr),_this.clearRequest()},xhr.open(this.getMethod(),this.buildUrl());for(var name in headers)headers.hasOwnProperty(name)&&xhr.setRequestHeader(name,headers[name]);xhr.send(this.getRequestBody()),this.xhr=xhr},HttpClient}();net.HttpClient=HttpClient}(hlk.net||(hlk.net={}));var net=hlk.net}(hlk||(hlk={}));var __extends=this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);__.prototype=b.prototype,d.prototype=new __},hlk;!function(hlk){!function(net){!function(loader){var Observer=hlk.Observer,MaterialLoader=function(_super){function MaterialLoader(list){if(_super.call(this),this.list=[],list)for(var i=0;i<list.length;i++)this.put(list[i]);this.loaded={}}return __extends(MaterialLoader,_super),MaterialLoader.prototype.put=function(item){this.list.push(item)},MaterialLoader.prototype.load=function(){this.loadSequence()},MaterialLoader.prototype.createItem=function(item){return"undefined"!=typeof item.type?this.createAudioItem(item):this.createImageItem(item)},MaterialLoader.prototype.createImageItem=function(item){var image=new Image;return image.src=item.src,image},MaterialLoader.prototype.createAudioItem=function(item){return new Audio(item.src,item.type)},MaterialLoader.prototype.loadSequence=function(){var item=this.list.shift(),self=this;if(item){var loadItem=this.createItem(item);loadItem.onload=function(){self.loaded[item.name]=loadItem,self.loadSequence(),loadItem.onerror=loadItem.onload=null,item=loadItem=self=null},loadItem.onerror=function(){console.log("[error]"+item.src),loadItem.onerror=loadItem.onload=null}}else this.onLoadFinish()},MaterialLoader.prototype.onLoadFinish=function(){this.notify("complete",this.loaded),this.loaded=null},MaterialLoader}(hlk.Observer);loader.MaterialLoader=MaterialLoader}(net.loader||(net.loader={}));var loader=net.loader}(hlk.net||(hlk.net={}));var net=hlk.net}(hlk||(hlk={}));var hlk;!function(hlk){!function(command){!function(event){var CommandEvent=function(_super){function CommandEvent(type,data,target){"undefined"==typeof data&&(data={}),"undefined"==typeof target&&(target=null),_super.call(this,type,data,target)}return __extends(CommandEvent,_super),CommandEvent.COMMAND_COMPLETE="sequenceComplete",CommandEvent.COMMAND_COMPLETE_ONE="sequenceCompleteOne",CommandEvent.COMMAND_ABORT="sequenceAbort",CommandEvent}(hlk.ObserverEvent);event.CommandEvent=CommandEvent}(command.event||(command.event={}));var event=command.event}(hlk.command||(hlk.command={}));var command=hlk.command}(hlk||(hlk={}));var hlk;!function(hlk){!function(command){var StringUtil=hlk.utils.StringUtil,CommandEvent=hlk.command.event.CommandEvent,Abstract=function(_super){function Abstract(name){"undefined"==typeof name&&(name=""),_super.call(this),this._name="",this._isComplete=!1;var name=name.length>0?name:"exec_"+StringUtil.getUnique();this.setName(name)}return __extends(Abstract,_super),Abstract.prototype.getName=function(){return this._name},Abstract.prototype.setName=function(name){this._name=name},Abstract.prototype.isComplete=function(){return this._isComplete},Abstract.prototype.setComplete=function(value){this._isComplete=value},Abstract.prototype.execute=function(data){throw this.setComplete(!1),new Error("require override")},Abstract.prototype._abort=function(){},Abstract.prototype.abort=function(){this.setComplete(!0),this._abort(),this.notify(CommandEvent.COMMAND_ABORT),this.clear()},Abstract.prototype.complete=function(data){this.isComplete()||(this.setComplete(!0),this.notify(CommandEvent.COMMAND_COMPLETE,data),this.clear())},Abstract.prototype.notify=function(type,data){"undefined"==typeof data&&(data={}),this.observeEvent(new CommandEvent(type,data,this))},Abstract.prototype.clear=function(){},Abstract}(hlk.Observer);command.Abstract=Abstract}(hlk.command||(hlk.command={}));var command=hlk.command}(hlk||(hlk={}));var hlk;!function(hlk){!function(command){var CommandEvent=hlk.command.event.CommandEvent,Sequence=function(_super){function Sequence(){for(var commands=[],_i=0;_i<arguments.length-0;_i++)commands[_i]=arguments[_i+0];_super.call(this),this._initialize(commands),this._isExecute=!1}return __extends(Sequence,_super),Sequence.prototype._initialize=function(commands){var queue=[];if(commands)for(var count=commands.length,i=0;count>i;i++)commands[i]instanceof command.Abstract&&queue.push(commands[i]);this._queue=queue},Sequence.prototype.getCurrent=function(){return this._current},Sequence.prototype.add=function(cmd){return cmd instanceof command.Abstract&&this._queue.push(cmd),this},Sequence.prototype.remove=function(cmd){var index=this._queue.indexOf(cmd);return index>=0&&this._queue.splice(index,1),this},Sequence.prototype.execute=function(data){if(!this._isExecute&&!this.isComplete()){this.setComplete(!1),this._isExecute=!0;var command=this._queue.shift();this._current=command,command.addObserver(CommandEvent.COMMAND_COMPLETE,this.completeOne,this),command.execute.apply(command,arguments)}},Sequence.prototype._abort=function(){this._isExecute=!1;var command=this.getCurrent();null!=command&&command.abort()},Sequence.prototype.completeOne=function(event){if(this._isExecute){var command=event.target;command.removeObserver(CommandEvent.COMMAND_COMPLETE,this.completeOne),command.clear(),this._current=null,this._isExecute=!1,this._queue.length>0?this.execute(event.data):this.complete(event.data)}},Sequence}(command.Abstract);command.Sequence=Sequence}(hlk.command||(hlk.command={}));var command=hlk.command}(hlk||(hlk={}));var hlk;!function(hlk){!function(command){var CommandEvent=hlk.command.event.CommandEvent,Parallel=function(_super){function Parallel(){for(var commands=[],_i=0;_i<arguments.length-0;_i++)commands[_i]=arguments[_i+0];_super.call(this),this._execCount=0,this._initialize(commands),this._results=[]}return __extends(Parallel,_super),Parallel.prototype.completeOne=function(event){var cmd=event.target;cmd.removeObserver(CommandEvent.COMMAND_COMPLETE,this.completeOne),cmd.clear(),this._execCount--,this._results.push(event.data),this._execCount<=0&&(this._isExecute=!1,this.complete(this._results))},Parallel.prototype.execute=function(data){if(!this._isExecute&&!this.isComplete()){this._isExecute=!0,this.setComplete(!1),this._execCount=0;var queue=this._queue;if(queue.reverse(),0!==queue.length)for(;queue.length;){var cmd=queue.pop();this._execCount++,cmd.addObserver(CommandEvent.COMMAND_COMPLETE,this.completeOne,this),cmd.execute(data)}else this.complete(data)}},Parallel.prototype._abort=function(){for(var queue=this._queue,count=queue.length,i=0;count>i;i++)queue[i].abort();this._isExecute=!1},Parallel}(command.Sequence);command.Parallel=Parallel}(hlk.command||(hlk.command={}));var command=hlk.command}(hlk||(hlk={}));var hlk;!function(hlk){!function(command){var Call=function(_super){function Call(fn){_super.call(this),this.fn=fn}return __extends(Call,_super),Call.prototype.execute=function(data){this.setComplete(!1);var arg=this.fn(data);"undefined"==typeof arg&&(arg=data),this.complete(arg)},Call}(command.Abstract);command.Call=Call}(hlk.command||(hlk.command={}));var command=hlk.command}(hlk||(hlk={}));var hlk;!function(hlk){!function(command){var MaterialLoader=hlk.net.loader.MaterialLoader,Loader=function(_super){function Loader(list){_super.call(this),this.list=list,this.setComplete(!1)}return __extends(Loader,_super),Loader.prototype.execute=function(data){if(!this.isComplete()){var self=this,loader=new MaterialLoader(this.list);this.setComplete(!1),loader.addObserver("complete",function completeLoad(event){loader.removeObserver("complete",completeLoad),self.complete(event.data),self.list=null,loader=null}),loader.load()}},Loader}(command.Abstract);command.Loader=Loader}(hlk.command||(hlk.command={}));var command=hlk.command}(hlk||(hlk={}));var hlk;!function(hlk){!function(command){var Wait=function(_super){function Wait(time){_super.call(this),this._timeout=time,this._timerId=0}return __extends(Wait,_super),Wait.prototype._abort=function(){clearTimeout(this._timerId)},Wait.prototype.execute=function(data){var _this=this;this.isComplete()||(this.setComplete(!1),this._timerId=setTimeout(function(){_this.complete(data),clearTimeout(_this._timerId)},this._timeout))},Wait}(command.Abstract);command.Wait=Wait}(hlk.command||(hlk.command={}));var command=hlk.command}(hlk||(hlk={}));var hlk;!function(hlk){!function(command){var HttpClient=hlk.net.HttpClient,Ajax=function(_super){function Ajax(method,url,requestBody,queryParam,headers,success,error){"undefined"==typeof requestBody&&(requestBody=null),"undefined"==typeof queryParam&&(queryParam=null),"undefined"==typeof headers&&(headers=null),"undefined"==typeof success&&(success=function(){}),"undefined"==typeof error&&(error=function(){}),_super.call(this),this.success=success,this.error=error,this.ajax=new HttpClient(method),this.ajax.setUrl(url),null!=requestBody&&this.ajax.setRequestBody(requestBody),null!=queryParam&&this.ajax.setQueryParams(queryParam),null!=headers&&this.ajax.addHeaders(headers)}return __extends(Ajax,_super),Ajax.prototype._abort=function(){this.ajax.abort()},Ajax.prototype.execute=function(data){this.setComplete(!1),this.ajax.send(this._createCallback(this.success,data),this._createCallback(this.error,data))},Ajax.prototype._createCallback=function(callback,data){var self=this;return function(xhr){var arg=callback.apply(self,[xhr,data]);self.complete(arg),self.ajax=null,self=null}},Ajax}(command.Abstract);command.Ajax=Ajax}(hlk.command||(hlk.command={}));var command=hlk.command}(hlk||(hlk={}));